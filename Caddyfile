:80 {
	# Root directory for static files
	root * /usr/share/caddy/html

	# Gzip compression
	encode gzip

	# Cache static assets
	@static {
		file
		path *.js *.css *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2
	}
	header @static Cache-Control "public, max-age=31536000, immutable"

	# API Proxy with HTTP/2 cleartext (h2c) to backend
	# Using h2c prevents HTTP desync attacks by using HTTP/2's binary protocol
	handle /api/* {
		reverse_proxy h2c://backend:3001 {
			header_up Host {host}
			header_up X-Real-IP {remote_host}
		}
	}

	# SPA routing - serve index.html for all other routes
	handle {
		try_files {path} /index.html
		file_server
	}
}
